import{d as h,a4 as B,aF as $,Z as g,an as v,bh as l,b8 as N,bi as w,bj as D,c as m,o as q,V as S,h as A}from"./entry.21f8f926.js";import{p as L}from"./index.c332151d.js";import{f as E,h as F}from"./index.30ac238c.js";const y=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"],b="default",x=/^@|^v-on:/,_=/^:|^v-bind:/,j=/^v-model/,V=["select","textarea","input"],I=Object.fromEntries(["p","a","blockquote","code","pre","code","em","h1","h2","h3","h4","h5","h6","hr","img","ul","ol","li","strong","table","thead","tbody","td","th","tr"].map(t=>[t,`prose-${t}`])),P=h({name:"MDCRenderer",props:{body:{type:Object,required:!0},data:{type:Object,default:()=>({})},excerpt:{type:Boolean,default:!1},tag:{type:String,default:void 0},prose:{type:Boolean,default:void 0},components:{type:Object,default:()=>({})}},async setup(t){const{mdc:e}=B().public,n={...e.components.prose&&t.prose!==!1?I:{},...e.components.map,...$(t.data?.mdc?.components||{}),...t.components};return await X(t.body,{tags:n}),{tags:n}},render(t){const{tags:e,tag:n,body:s,data:r}=t;if(!s)return null;const o={...r,tags:e};let i=n||o.component?.name||o.component||"div";return i=O(i),g(i,{...o.component?.props,...this.$attrs},T(s,g,o,o))}});function W(t,e,n,s={}){if(t.type==="text")return e(l,t.value);if(t.tag==="script")return e(l,C(t));const r=t.tag,o=typeof t.props?.__ignoreMap>"u"&&n.tags[r]||r;if(t.tag==="binding")return z(t,e,n,s);const i=O(o);typeof i=="object"&&(i.tag=r);const c=U(t,n);return e(i,c,T(t,e,n,{...s,...c}))}function C(t){return t.type==="text"?t.value:t.children?.length?`<${t.tag}>${t.children?.map(C).join("")||""}</${t.tag}>`:`<${t.tag}>`}function z(t,e,n,s={}){const r={...s,$route:()=>N(),$document:n,$doc:n},o=/\.|\[(\d+)\]/,c=(t.props?.value.trim().split(o).filter(Boolean)).reduce((a,u)=>u in a?typeof a[u]=="function"?a[u]():a[u]:{},r);return e(l,c)}function T(t,e,n,s){const o=(t.children||[]).reduce((c,a)=>{if(!M(a))return c[b].push(a),c;const u=K(a);return c[u]=c[u]||[],a.type==="element"&&c[u].push(...a.children||[]),c},{[b]:[]});return Object.entries(o).reduce((c,[a,u])=>(u.length&&(c[a]=()=>{const d=u.map(p=>W(p,e,n,s));return Q(d)}),c),{})}function U(t,e){const{tag:n="",props:s={}}=t;return Object.keys(s).reduce(function(r,o){if(o==="__ignoreMap")return r;const i=s[o];if(j.test(o)&&!V.includes(n))return Z(o,i,r,e);if(o==="v-bind")return G(o,i,r,e);if(x.test(o))return H(o,i,r,e);if(_.test(o))return J(o,i,r,e);const{attribute:c}=E(F,o);return Array.isArray(i)&&i.every(a=>typeof a=="string")?(r[c]=i.join(" "),r):(r[c]=i,r)},{})}function Z(t,e,n,s){const r=p=>+p,o=p=>p.trim(),i=p=>p,c=t.replace(j,"").split(".").filter(p=>p).reduce((p,R)=>(p[R]=!0,p),{}),a="value",u=c.lazy?"change":"input",d=c.number?r:c.trim?o:i;return n[a]=f(e,s),n.on=n.on||{},n.on[u]=p=>s[e]=d(p),n}function G(t,e,n,s){const r=f(e,s);return n=Object.assign(n,r),n}function H(t,e,n,s){return t=t.replace(x,""),n.on=n.on||{},n.on[t]=()=>f(e,s),n}function J(t,e,n,s){return t=t.replace(_,""),n[t]=f(e,s),n}const O=t=>{if(!y.includes(t)&&!t?.render){const e=v(L(t),!1);if(typeof e=="object")return e}return t};function f(t,e){const n=t.split(".").reduce((s,r)=>typeof s=="object"?s[r]:void 0,e);return typeof n>"u"?w(t):n}function K(t){let e="";for(const n of Object.keys(t.props||{}))if(!(!n.startsWith("#")&&!n.startsWith("v-slot:"))){e=n.split(/[:#]/,2)[1];break}return e||b}function M(t){return t.tag==="template"}function Q(t){const e=[];for(const n of t){const s=e[e.length-1];n.type===l&&s?.type===l?s.children=s.children+n.children:e.push(n)}return e}async function X(t,e){const n=Array.from(new Set(s(t,e)));await Promise.all(n.map(async r=>{if(r?.render||r?.ssrRender)return;const o=v(r);o?.__asyncLoader&&!o.__asyncResolved&&await o.__asyncLoader()}));function s(r,o){const i=r.tag;if(r.type==="text"||i==="binding")return[];const c=typeof r.props?.__ignoreMap>"u"&&o.tags[i]||i,a=[];r.type!=="root"&&!y.includes(c)&&a.push(c);for(const u of r.children||[])a.push(...s(u,o));return a}}const et=h({__name:"ContentRendererMarkdown",props:{value:{type:Object,required:!0},excerpt:{type:Boolean,default:!1},tag:{type:String,default:"div"},components:{type:Object,default:()=>({})}},setup(t){const e=t,n=D().isEnabled(),s=m(()=>{let i=e.value.body||e.value;return e.excerpt&&e.value.excerpt&&(i=e.value.excerpt),i}),r=m(()=>{const{body:i,excerpt:c,...a}=e.value;return a}),o=m(()=>({...e.components,...r.value._components||{}}));return(i,c)=>{const a=P;return q(),S(a,{body:s.value,data:r.value,tag:t.tag,components:o.value,"data-content-id":A(n)?t.value._id:void 0},null,8,["body","data","tag","components","data-content-id"])}}});export{et as _};
